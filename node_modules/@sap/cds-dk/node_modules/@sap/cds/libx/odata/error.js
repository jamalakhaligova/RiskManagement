const { normalizeError } = require('../_runtime/common/error/frontend')
const { odataError } = require('./utils')

module.exports = _srv => (err, req, res, _next) => {
  const { error, statusCode } = normalizeError(err, req)

  if (statusCode >= 400 && statusCode < 500) {
    return res.status(statusCode).json(odataError(`${err.code}`, error.message))
  }

  return res.status(500).send('Internal Server Error')
}
